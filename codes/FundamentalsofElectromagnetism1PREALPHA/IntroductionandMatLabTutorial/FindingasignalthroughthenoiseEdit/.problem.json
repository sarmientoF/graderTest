{"session":{"apiVersion":"","sessionId":""},"problem":{"apiVersion":"2.0","title":"Finding a signal through the noise","description":{"opcPackage":"{\"parts\":[{\"partUri\":\"/matlab/document.xml\",\"contentType\":\"application/vnd.mathworks.matlab.code.document+xml\",\"content\":\"\u003c?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?\u003e\u003cw:document xmlns:w=\\\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\\\"\u003e\u003cw:body\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eThis example demonstrates using random numbers to initialize a problem and add noise to a signal. Students can see the frequency of the signal to know if their answer is close, but must correctly code the result because the frequency of the FFT differs from frequency used to generate the signal. See note in the reference solution. \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003e\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eAs shown in class, Fourier Transforms are used to convert time domain data to the frequency domain and show up in many different application areas. Fourier Transforms also help find signals from noisy time-domain data. \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:customXml w:element=\\\"image\\\"\u003e\u003cw:customXmlPr\u003e\u003cw:attr w:name=\\\"height\\\" w:val=\\\"300\\\"/\u003e\u003cw:attr w:name=\\\"width\\\" w:val=\\\"903\\\"/\u003e\u003cw:attr w:name=\\\"relationshipId\\\" w:val=\\\"rId1\\\"/\u003e\u003c/w:customXmlPr\u003e\u003c/w:customXml\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eThe script below starts by creating a signal with a random amplitude, \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003eA\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e, and random frequency, \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003ef\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e. The signal is sampled at 500 Hz and consists of 512 points. The provided code creates and plots the noisy signal, \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003eS\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e. Your task is to use the \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:hyperlink w:docLocation=\\\"https://www.mathworks.com/help/matlab/ref/fft.html\\\"\u003e\u003cw:r\u003e\u003cw:t\u003efft\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:hyperlink\u003e\u003cw:r\u003e\u003cw:t\u003e function to find the frequency and amplitude of a noisy signal.\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eTo do this you need to:\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eCreate a vector \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003efreq\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e to map the magnitude of the FFT to. Remember that \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003efreq\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e should start at 0 and end at \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003eFs/2\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e.\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eFind the frequency of the peak in the Fourier Transform and store the result in the variable \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003efftFrequency\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eNote that due to the sampling rate, \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:b/\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003efftFrequency\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e will differ slightly from the frequency used to create the signal. \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003c/w:body\u003e\u003c/w:document\u003e\",\"relationship\":[{\"relationshipType\":\"http://schemas.mathworks.com/matlab/code/2013/relationships/image\",\"target\":\"/media/image1.png\",\"relationshipId\":\"rId1\"}]},{\"partUri\":\"/media/image1.png\",\"contentType\":\"image/png\",\"content\":\"https://lcms-files.mathworks.com/content/images/c847a803-eb72-49e1-b136-debb4d66987d.png\",\"relationship\":null}],\"relationships\":[{\"relationshipType\":\"http://schemas.mathworks.com/matlab/code/2013/relationships/document\",\"target\":\"/matlab/document.xml\",\"relationshipId\":\"rId1\"}]}","html":"\u003cdiv style = \"text-align: start; line-height: 16px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; \"\u003e\u003cdiv style=\"display: block; min-width: 0px; padding-top: 0px; transform-origin: 759.5px 290.5px; perspective-origin: 759.5px 290.5px; \"\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 21px; white-space: pre-wrap; perspective-origin: 736.5px 21px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eThis example demonstrates using random numbers to initialize a problem and add noise to a signal. Students can see the frequency of the signal to know if their answer is close, but must correctly code the result because the frequency of the FFT differs from frequency used to generate the signal. See note in the reference solution. \u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 10.5px; white-space: pre-wrap; perspective-origin: 736.5px 10.5px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e\u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 10.5px; white-space: pre-wrap; perspective-origin: 736.5px 10.5px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eAs shown in class, Fourier Transforms are used to convert time domain data to the frequency domain and show up in many different application areas. Fourier Transforms also help find signals from noisy time-domain data. \u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 153px; white-space: pre-wrap; perspective-origin: 736.5px 153px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cimg class=\"imageNode\" width=\"903\" height=\"300\" style=\"vertical-align: baseline;width: 903px;height: 300px\" src=\"https://lcms-files.mathworks.com/content/images/8f1aa578-35ad-4945-a352-7848298ab57e.png\"\u003e\u003c/div\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 21px; white-space: pre-wrap; perspective-origin: 736.5px 21px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eThe script below starts by creating a signal with a random amplitude, \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003eA\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e, and random frequency, \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003ef\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e. The signal is sampled at 500 Hz and consists of 512 points. The provided code creates and plots the noisy signal, \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003eS\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e. Your task is to use the \u003c/span\u003e\u003c/span\u003e\u003ca target='_blank' href = 'https://www.mathworks.com/help/matlab/ref/fft.html'\u003e\u003cspan style=\"\"\u003e\u003cspan style=\"\"\u003efft\u003c/span\u003e\u003c/span\u003e\u003c/a\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e function to find the frequency and amplitude of a noisy signal.\u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 10.5px; white-space: pre-wrap; perspective-origin: 736.5px 10.5px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eTo do this you need to:\u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003col style=\"font-family: Helvetica, Arial, sans-serif; list-style-type: decimal; margin-bottom: 20px; margin-top: 10px; transform-origin: 743.5px 16px; perspective-origin: 743.5px 16px; margin-top: 10px; margin-bottom: 20px; \"\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 715.5px 8px; white-space: pre-wrap; perspective-origin: 715.5px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eCreate a vector \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003efreq\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e to map the magnitude of the FFT to. Remember that \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003efreq\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e should start at 0 and end at \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; \"\u003eFs/2\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e.\u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 715.5px 8px; white-space: pre-wrap; perspective-origin: 715.5px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eFind the frequency of the peak in the Fourier Transform and store the result in the variable \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003efftFrequency\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e \u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003c/ol\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 736.5px 10.5px; white-space: pre-wrap; perspective-origin: 736.5px 10.5px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eNote that due to the sampling rate, \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; font-weight: bold; \"\u003efftFrequency\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e will differ slightly from the frequency used to create the signal. \u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003c/div\u003e\u003c/div\u003e"},"starterCode":{"code":"% Create a noisy, exponentially decaying signal\n% With a random amplitude and frequency.\nA = randi([1 5]);    % Amplitude bewteen 1 and 5\nf = randi([50 79]);  % frequency between 50 and 79 Hz\nFs = 500;            % Sampling frequency in Hz\ndt = 1/Fs;           % Sampling period\nL = 512;             % Aquire 512 points\nt = (0:L-1)*dt;      % Time vector\nS = A*cos(2*pi*f*t) + randn(size(t));   % Signal with noise\n% Plot the signal and show the frequency and amplitude\nfigure; plot(t,S)\ntitle([num2str(f), ' Hz signal with amplitude = ', num2str(A)])\nxlabel('Time (s)')\nylabel('Amplitude (A.U.)')\n\n% Take the FFT and find the frequency of the peak\n\n\n","lockedRows":[1,2,3,4,5,6,7,8,9,10,11,12,13,14]},"referenceSolution":"% NOTE - The frequency range in randi was chosen so that a submission of\n% fftFrequency = f;\n% will fail because fftFrequncy - f is outside the default tolerance range.\n% Create a noisy, signal with a random amplitude and frequency.\nA = randi([1 5]);    % Amplitude bewteen 1 and 5\nf = randi([50 79]);  % frequency between 50 and 79 Hz\nFs = 500;            % Sampling frequency in Hz\ndt = 1/Fs;           % Sampling period\nL = 512;             % Aquire 512 points\nt = (0:L-1)*dt;      % Time vector\nS = A*cos(2*pi*f*t) + randn(size(t));   % Signal with noise\n% Plot the signal and show the frequency and amplitude\nfigure; plot(t,S)\ntitle([num2str(f), ' Hz signal with amplitude = ', num2str(A)])\nxlabel('Time (s)')\nylabel('Amplitude (A.U.)')\n\n% Take the FFT and find the frequency of the peak\nY = abs(fft(S));\nfreq = linspace(0, Fs/2, L/2 + 1);\nY1 = Y(1:length(freq));\n% Note that plotting is encouraged and usually helpful, but not necessary\n% for grading. Instead, grade the vectors of interest directly.\nfigure; plot(freq, Y1)\n\n% Find the location of the peak and amplitude of peak\n[fftmax, ind] = max(Y1)\nfftFrequency = freq(ind)\n","isPublished":false,"hasDependentFeedback":true,"userFiles":[],"assessments":[{"code":"assessVariableEqual('freq', referenceVariables.freq);","description":"Was the vector of frequencies created correctly?","feedbackOnIncorrect":{"opcPackage":"{\"parts\":[{\"partUri\":\"/matlab/document.xml\",\"contentType\":\"application/vnd.mathworks.matlab.code.document+xml\",\"content\":\"\u003c?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?\u003e\u003cw:document xmlns:w=\\\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\\\"\u003e\u003cw:body\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"text\\\"/\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eTo find the peak frequency, we first need to use the information about how the time-domain signal was aquired to create a vector of frequencies. The vector of frequencies must\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eStart at 0\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eEnd at \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003eFs/2\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eContain \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003eL/2 + 1\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:t\u003e elements\u003c/w:t\u003e\u003c/w:r\u003e\u003cw:r\u003e\u003cw:rPr\u003e\u003cw:rFonts w:cs=\\\"monospace\\\"/\u003e\u003c/w:rPr\u003e\u003cw:t\u003e \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003c/w:body\u003e\u003c/w:document\u003e\",\"relationship\":null}],\"relationships\":[{\"relationshipType\":\"http://schemas.mathworks.com/matlab/code/2013/relationships/document\",\"target\":\"/matlab/document.xml\",\"relationshipId\":\"rId1\"}]}","html":"\u003cdiv style = \"text-align: start; line-height: 16px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; \"\u003e\u003cdiv style=\"display: block; min-width: 0px; padding-top: 0px; transform-origin: 549.671875px 39.5px; perspective-origin: 549.671875px 39.5px; \"\u003e\u003cdiv style=\"font-family: Helvetica, Arial, sans-serif; line-height: 21px; margin-bottom: 9px; margin-left: 4px; margin-right: 10px; margin-top: 2px; text-align: left; transform-origin: 542.671875px 10.5px; white-space: pre-wrap; perspective-origin: 542.671875px 10.5px; margin-left: 4px; margin-top: 2px; margin-bottom: 9px; margin-right: 10px; \"\u003e\u003cspan style=\"display: inline; margin-bottom: 0px; margin-left: 0px; margin-right: 0px; margin-top: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eTo find the peak frequency, we first need to use the information about how the time-domain signal was aquired to create a vector of frequencies. The vector of frequencies must\u003c/span\u003e\u003c/span\u003e\u003c/div\u003e\u003col style=\"font-family: Helvetica, Arial, sans-serif; list-style-type: decimal; margin-bottom: 20px; margin-top: 10px; transform-origin: 549.671875px 24px; perspective-origin: 549.671875px 24px; margin-top: 10px; margin-bottom: 20px; \"\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 521.671875px 8px; white-space: pre-wrap; perspective-origin: 521.671875px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eStart at 0\u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 521.671875px 8px; white-space: pre-wrap; perspective-origin: 521.671875px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eEnd at \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; \"\u003eFs/2\u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 521.671875px 8px; white-space: pre-wrap; perspective-origin: 521.671875px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eContain \u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; \"\u003eL/2 + 1\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e elements\u003c/span\u003e\u003c/span\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"font-family: Menlo, Monaco, Consolas, \u0026quot;Courier New\u0026quot;, monospace; \"\u003e \u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/div\u003e\u003c/div\u003e"},"isVisible":false,"weight":1,"weightInPercent":33,"type":"variableEquals","variableList":[],"selectedVariable":"freq"},{"code":"assessVariableEqual('fftFrequency', referenceVariables.fftFrequency);","description":"Was the frequency of the peak found correctly?","feedbackOnIncorrect":{"opcPackage":"{\"parts\":[{\"partUri\":\"/matlab/document.xml\",\"contentType\":\"application/vnd.mathworks.matlab.code.document+xml\",\"content\":\"\u003c?xml version=\\\"1.0\\\" encoding=\\\"UTF-8\\\"?\u003e\u003cw:document xmlns:w=\\\"http://schemas.openxmlformats.org/wordprocessingml/2006/main\\\"\u003e\u003cw:body\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eIt is helpful to first calculate the single-sided FFT of the signal. \u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003cw:p\u003e\u003cw:pPr\u003e\u003cw:pStyle w:val=\\\"ListParagraph\\\"/\u003e\u003cw:numPr\u003e\u003cw:numId w:val=\\\"2\\\"/\u003e\u003c/w:numPr\u003e\u003cw:jc w:val=\\\"left\\\"/\u003e\u003c/w:pPr\u003e\u003cw:r\u003e\u003cw:t\u003eThen, try using the \u003c/w:t\u003e\u003c/w:r\u003e\u003cw:hyperlink w:docLocation=\\\"https://www.mathworks.com/help/matlab/ref/max.html\\\"\u003e\u003cw:r\u003e\u003cw:t\u003emax\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:hyperlink\u003e\u003cw:r\u003e\u003cw:t\u003e function with two output variables and see if you can use the 2nd output to find the frequency of the peak.\u003c/w:t\u003e\u003c/w:r\u003e\u003c/w:p\u003e\u003c/w:body\u003e\u003c/w:document\u003e\",\"relationship\":null}],\"relationships\":[{\"relationshipType\":\"http://schemas.mathworks.com/matlab/code/2013/relationships/document\",\"target\":\"/matlab/document.xml\",\"relationshipId\":\"rId1\"}]}","html":"\u003cdiv style = \"text-align: start; line-height: 16px; min-height: 0px; white-space: normal; color: rgb(0, 0, 0); font-family: Menlo, Monaco, Consolas, monospace; font-style: normal; font-size: 14px; font-weight: normal; text-decoration: none; white-space: normal; \"\u003e\u003cdiv style=\"display: block; min-width: 0px; padding-top: 0px; transform-origin: 428.796875px 16px; perspective-origin: 428.796875px 16px; \"\u003e\u003col style=\"font-family: Helvetica, Arial, sans-serif; list-style-type: decimal; margin-bottom: 20px; margin-top: 10px; margin-top: 10px; margin-bottom: 20px; \"\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 400.796875px 8px; white-space: pre-wrap; perspective-origin: 400.796875px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eIt is helpful to first calculate the single-sided FFT of the signal. \u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003cli style=\"display: list-item; margin-bottom: 0px; margin-left: 56px; margin-top: 0px; text-align: left; transform-origin: 400.796875px 8px; white-space: pre-wrap; perspective-origin: 400.796875px 8px; margin-left: 56px; \"\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003eThen, try using the \u003c/span\u003e\u003c/span\u003e\u003ca target='_blank' href = 'https://www.mathworks.com/help/matlab/ref/max.html'\u003e\u003cspan style=\"\"\u003e\u003cspan style=\"\"\u003emax\u003c/span\u003e\u003c/span\u003e\u003c/a\u003e\u003cspan style=\"display: inline; margin-left: 0px; transform-origin: 0px 0px; perspective-origin: 0px 0px; \"\u003e\u003cspan style=\"\"\u003e function with two output variables and see if you can use the 2nd output to find the frequency of the peak.\u003c/span\u003e\u003c/span\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/div\u003e\u003c/div\u003e"},"isVisible":false,"weight":2,"weightInPercent":67,"type":"variableEquals","variableList":[],"selectedVariable":"fftFrequency"}],"numAssessments":null,"problemType":"script","runTemplate":{"code":""},"assessmentMethod":"points","isResultScoreVisible":true},"submission":{"solution":{"code":"","lockedRows":[]},"runTemplate":{"code":""},"submitResponse":null},"problemMetadata":{"problemId":122987,"lcmsDocumentId":"26ad5f3b-a198-41f2-a354-28ea180b76c8","contentSource":"mwa"},"features":{"apiVersion":"","functions":true,"getProblemEndpoint":false,"getLatestSubmissionEndpoint":false,"fileUpload":true,"learnerSave":false,"visibleTests":true,"problemChooser":true,"publicCatalog":false,"testDependency":true,"partialGrading":true,"lrs":false,"function_assessment_type":true},"userData":{"apiVersion":"","role":"instructor","userId":13322701,"userType":"mwa","hasPublicCatalogAccess":false},"serverData":{"endpoints":{"messageServiceEndpoint":"/services/json","getGetCatalogProblemsEndpoint":"/catalog/grouped_problems","getCatalogGroupsEndpoint":"/catalog/groups","analyticsBaseEndpoint":"https://learninganalytics.mathworks.com"}},"contentMetadata":{"contentId":122987,"contentTypeName":"problem"},"contentCollection":{"contentCollectionId":null,"contentCollectionType":"assignment"}}